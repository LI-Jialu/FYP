import pandas as pd 
from datetime import datetime  as dt 

df = pd.read_csv('./Data/BTCUSDT-1m-2021-10-02.csv', usecols=[0,1,4])
df.columns = ['timeStamp','Open','Close']
# df['date'] = [t for t in df['timeStamp']] 
# df.index_col = pd.to_datetime(df['date'])
print(df.head(10))

snapshot = pd.read_csv('./Data/bitmex_book_snapshot_25_2021-10-02_XBTUSD.csv', usecols = [2,4,6])
snapshot.columns = ['timeStamp','ask1','bid1']
# snapshot['date'] = [dt.fromtimestamp(t) for t in snapshot['timeStamp']] 
# snapshot.index_col = pd.to_datetime(snapshot['date'])
print(dt.fromtimestamp(1633132860000))
print(dt.fromtimestamp(1633132800900915))

print(snapshot.head(10))

# Binance Future BTC 
# Price 
'''
{'stream': 'btcusdt@markPrice@1s', 'data': {'e': 'markPriceUpdate', 'E': 1633132800004, 's': 'BTCUSDT', 'p': '48123.88852158', 'P': '48136.56992883', 'i': '48136.56992883', 'r': '0.00005277', 'T': 1633132800000}}
{'stream': 'btcusdt@markPrice@1s', 'data': {'e': 'markPriceUpdate', 'E': 1633132801007, 's': 'BTCUSDT', 'p': '48123.94000000', 'P': '48136.56992883', 'i': '48136.56992883', 'r': '0.00005277', 'T': 1633161600000}}
{'stream': 'btcusdt@markPrice@1s', 'data': {'e': 'markPriceUpdate', 'E': 1633132802000, 's': 'BTCUSDT', 'p': '48127.40938732', 'P': '48138.22706659', 'i': '48139.88420435', 'r': '0.00005277', 'T': 1633161600000}}
{'stream': 'btcusdt@markPrice@1s', 'data': {'e': 'markPriceUpdate', 'E': 1633132803000, 's': 'BTCUSDT', 'p': '48129.59986409', 'P': '48139.50960477', 'i': '48142.07468112', 'r': '0.00005277', 'T': 1633161600000}}
{'stream': 'btcusdt@markPrice@1s', 'data': {'e': 'markPriceUpdate', 'E': 1633132804000, 's': 'BTCUSDT', 'p': '48133.11310829', 'P': '48141.02918491', 'i': '48145.58792532', 'r': '0.00005277', 'T': 1633161600000}}

'''
# Depth 
'''
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132800022, 'T': 1633132800015, 's': 'BTCUSDT', 'U': 808229736503, 'u': 808229737986, 'pu': 808229736449, 'b': [['47995.86', '0.000'], ['48013.90', '0.000'], ['48047.53', '0.000'], ['48052.45', '0.200'], ['48082.90', '0.593'], ['48091.32', '0.480'], ['48093.30', '0.001'], ['48095.00', '0.000'], ['48102.93', '0.000'], ['48102.96', '0.000'], ['48107.54', '0.640'], ['48107.55', '0.000'], ['48108.15', '0.000'], ['48108.38', '0.000'], ['48108.88', '0.000'], ['48108.89', '0.000'], ['48109.89', '4.611'], ['48109.90', '0.475'], ['48110.70', '0.000'], ['48111.81', '0.000'], ['48112.23', '0.210'], ['48112.30', '0.000'], ['48114.08', '0.062'], ['48114.30', '0.156'], ['48115.00', '3.684'], ['48115.05', '0.000'], ['48115.39', '0.071'], ['48115.44', '0.062'], ['48115.56', '0.000'], ['48116.12', '0.000'], ['48116.86', '0.416'], ['48116.96', '0.090'], ['48117.85', '0.000'], ['48117.87', '0.000'], ['48117.88', '0.000'], ['48117.89', '0.177'], ['48118.77', '0.247'], ['48118.83', '0.062'], ['48118.89', '0.000'], ['48119.96', '0.550'], ['48119.97', '3.610'], ['48119.98', '1.100'], ['48119.99', '1.316'], ['48120.84', '0.008'], ['48121.04', '0.004'], ['48123.42', '0.000'], ['48123.43', '0.000'], ['48123.58', '0.000'], ['48123.59', '0.000'], ['48123.60', '0.004'], ['48123.88', '0.000'], ['48123.92', '0.022'], ['48123.93', '0.000'], ['48124.23', '0.000'], ['48124.95', '0.000'], ['48124.99', '0.000'], ['48125.39', '0.000']], 'a': [['48119.97', '0.000'], ['48123.43', '0.000'], ['48123.59', '0.000'], ['48123.61', '0.000'], ['48123.94', '0.000'], ['48124.24', '0.000'], ['48124.96', '0.000'], ['48127.60', '0.042'], ['48127.94', '0.300'], ['48127.96', '0.000'], ['48128.58', '0.060'], ['48129.42', '1.000'], ['48129.50', '0.590'], ['48129.51', '0.100'], ['48129.52', '0.000'], ['48129.53', '0.013'], ['48131.67', '0.333'], ['48132.77', '0.083'], ['48133.84', '0.070'], ['48134.63', '0.100'], ['48138.27', '0.000'], ['48139.27', '0.062'], ['48139.96', '0.000'], ['48142.66', '2.000'], ['48144.03', '0.001'], ['48145.12', '0.031'], ['48145.82', '0.058'], ['48148.37', '0.000'], ['48153.31', '0.000']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132800054, 'T': 1633132800047, 's': 'BTCUSDT', 'U': 808229737994, 'u': 808229739810, 'pu': 808229737986, 'b': [['48028.07', '0.012'], ['48054.62', '0.570'], ['48075.16', '0.000'], ['48077.90', '0.000'], ['48078.18', '0.541'], ['48082.26', '0.000'], ['48096.81', '0.000'], ['48098.37', '0.000'], ['48103.46', '0.350'], ['48103.87', '0.000'], ['48106.96', '0.000'], ['48106.97', '0.000'], ['48107.39', '0.000'], ['48107.56', '0.000'], ['48107.57', '0.005'], ['48115.15', '0.333'], ['48115.38', '0.333'], ['48115.39', '0.009'], ['48116.41', '0.000'], ['48116.96', '0.422'], ['48117.14', '0.109'], ['48118.56', '0.142'], ['48119.96', '0.150'], ['48119.98', '0.000'], ['48119.99', '0.100'], ['48120.00', '1.217'], ['48120.01', '0.300'], ['48120.84', '0.000'], ['48122.89', '0.310'], ['48123.59', '0.000'], ['48123.60', '0.000'], ['48123.92', '0.248'], ['48124.99', '0.000']], 'a': [['48123.61', '0.000'], ['48123.93', '2.386'], ['48124.93', '0.000'], ['48124.94', '0.286'], ['48127.60', '0.155'], ['48127.61', '0.000'], ['48127.94', '0.000'], ['48128.56', '0.300'], ['48128.57', '0.826'], ['48128.58', '0.060'], ['48129.40', '0.400'], ['48129.41', '0.000'], ['48129.50', '0.000'], ['48129.51', '0.000'], ['48129.53', '0.000'], ['48130.13', '0.000'], ['48131.63', '0.332'], ['48131.64', '0.000'], ['48132.73', '0.000'], ['48134.63', '0.000'], ['48138.26', '0.000'], ['48140.29', '0.100'], ['48141.92', '1.216'], ['48142.18', '0.041'], ['48142.66', '0.000'], ['48143.37', '0.000'], ['48148.31', '0.000'], ['48148.33', '0.593'], ['48154.79', '1.123'], ['48161.64', '0.000'], ['48162.79', '0.000'], ['48165.88', '1.047'], ['48167.49', '1.039'], ['48171.36', '0.000'], ['48188.29', '0.000'], ['48213.49', '0.000']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132800088, 'T': 1633132800078, 's': 'BTCUSDT', 'U': 808229739904, 'u': 808229741408, 'pu': 808229739810, 'b': [['47883.31', '0.316'], ['48030.09', '0.000'], ['48060.73', '0.000'], ['48082.90', '0.000'], ['48084.03', '0.000'], ['48087.11', '0.104'], ['48102.70', '0.623'], ['48103.95', '0.295'], ['48110.96', '0.000'], ['48115.05', '0.100'], ['48117.03', '0.000'], ['48118.83', '0.000'], ['48119.99', '0.000'], ['48120.00', '0.324'], ['48120.01', '0.100'], ['48120.02', '0.000'], ['48120.87', '0.008'], ['48123.92', '0.252']], 'a': [['48122.90', '0.000'], ['48123.93', '0.013'], ['48127.98', '0.000'], ['48131.19', '0.332'], ['48134.09', '0.623'], ['48134.63', '0.100'], ['48139.09', '0.000'], ['48139.33', '0.000'], ['48140.29', '0.000'], ['48142.19', '0.000'], ['48142.83', '2.000'], ['48148.32', '0.378'], ['48148.33', '0.605'], ['48148.68', '0.332'], ['48155.92', '0.000'], ['48167.48', '0.013'], ['48183.35', '0.110'], ['48364.55', '0.313']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132800121, 'T': 1633132800115, 's': 'BTCUSDT', 'U': 808229741585, 'u': 808229743080, 'pu': 808229741408, 'b': [['47883.32', '1.500'], ['48000.42', '0.000'], ['48082.90', '0.593'], ['48107.01', '0.000'], ['48107.28', '0.000'], ['48116.86', '0.000'], ['48118.60', '0.000'], ['48118.77', '0.103'], ['48119.98', '1.100'], ['48119.99', '0.700'], ['48120.00', '0.236'], ['48120.01', '0.150'], ['48120.02', '0.231'], ['48120.15', '0.004'], ['48120.87', '0.000'], ['48121.25', '0.008'], ['48123.92', '1.448'], ['48124.93', '0.000'], ['48124.99', '0.000']], 'a': [['48123.92', '0.000'], ['48123.93', '6.141'], ['48128.55', '0.300'], ['48128.56', '0.000'], ['48128.57', '0.626'], ['48129.38', '0.400'], ['48129.40', '0.000'], ['48131.19', '0.000'], ['48131.63', '0.000'], ['48134.63', '0.000'], ['48140.11', '0.000'], ['48141.14', '0.100'], ['48147.99', '0.013'], ['48148.33', '0.012'], ['48167.55', '0.000'], ['48172.90', '0.000'], ['48208.81', '0.000'], ['48224.19', '0.207'], ['48233.31', '1.064'], ['49099.57', '0.000'], ['49122.12', '15.898']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132800153, 'T': 1633132800118, 's': 'BTCUSDT', 'U': 808229743161, 'u': 808229743161, 'pu': 808229743080, 'b': [['48119.96', '0.149']], 'a': []}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132802776, 'T': 1633132801102, 's': 'BTCUSDT', 'U': 808230154733, 'u': 808230154733, 'pu': 808229743161, 'b': [['48123.92', '1.449']], 'a': []}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132803113, 'T': 1633132801211, 's': 'BTCUSDT', 'U': 808230217081, 'u': 808230217087, 'pu': 808230154733, 'b': [['48120.02', '0.293']], 'a': [['48123.93', '7.061'], ['48177.71', '0.000']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132803655, 'T': 1633132801385, 's': 'BTCUSDT', 'U': 808230314966, 'u': 808230314966, 'pu': 808230217087, 'b': [], 'a': [['48168.55', '0.000']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132803690, 'T': 1633132801397, 's': 'BTCUSDT', 'U': 808230321390, 'u': 808230321588, 'pu': 808230314966, 'b': [['48115.16', '0.002'], ['48116.10', '0.000'], ['48116.96', '0.332'], ['48117.89', '0.104'], ['48119.98', '0.300'], ['48119.99', '0.300'], ['48120.02', '0.251'], ['48121.04', '0.000'], ['48123.92', '1.229']], 'a': [['48123.92', '0.000'], ['48129.38', '0.000'], ['48148.31', '0.593'], ['48176.86', '2.494']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132803864, 'T': 1633132801460, 's': 'BTCUSDT', 'U': 808230356683, 'u': 808230356695, 'pu': 808230321588, 'b': [['48123.93', '0.000']], 'a': [['48123.93', '6.552']]}}
{'stream': 'btcusdt@depth@0ms', 'data': {'e': 'depthUpdate', 'E': 1633132804505, 'T': 1633132801678, 's': 'BTCUSDT', 'U': 808230474304, 'u': 808230474304, 'pu': 808230356695, 'b': [], 'a': [['48206.58', '0.000']]}}
'''
# Depth Snap shot 
# snapshot_5 
# snapshot_25
'''
binance-futures	BTCUSDT	1633132800118000	1633132801028740	48123.93	6.141	48123.92	1.448	48124.94	0.286	48122.89	0.31	48125	0.001	48121.25	0.008	48125.4	0.058	48121.04	0.004	48127.6	0.155	48120.15	0.004	48128.55	0.3	48120.02	0.231	48128.57	0.626	48120.01	0.15	48128.58	0.06	48120	0.236	48129.38	0.4	48119.99	0.7	48129.42	1	48119.98	1.1	48129.55	2.638	48119.97	3.61	48130	6.017	48119.96	0.149	48130.51	0.27	48119.48	0.227	48130.78	0.002	48118.82	0.247	48131.2	0.104	48118.77	0.103	48131.67	0.333	48118.76	0.104	48132.74	0.453	48118.56	0.142	48132.77	0.083	48117.89	0.177	48133.6	0.475	48117.84	0.854	48133.61	0.042	48117.14	0.109	48133.84	0.07	48116.96	0.422	48133.94	0.001	48116.87	0.229	48134.09	0.623	48116.4	0.293	48134.64	0.24	48116.15	0.312	48134.67	0.006	48116.13	0.062
binance-futures	BTCUSDT	1633132801102000	1633132802780080	48123.93	6.141	48123.92	1.449	48124.94	0.286	48122.89	0.31	48125	0.001	48121.25	0.008	48125.4	0.058	48121.04	0.004	48127.6	0.155	48120.15	0.004	48128.55	0.3	48120.02	0.231	48128.57	0.626	48120.01	0.15	48128.58	0.06	48120	0.236	48129.38	0.4	48119.99	0.7	48129.42	1	48119.98	1.1	48129.55	2.638	48119.97	3.61	48130	6.017	48119.96	0.149	48130.51	0.27	48119.48	0.227	48130.78	0.002	48118.82	0.247	48131.2	0.104	48118.77	0.103	48131.67	0.333	48118.76	0.104	48132.74	0.453	48118.56	0.142	48132.77	0.083	48117.89	0.177	48133.6	0.475	48117.84	0.854	48133.61	0.042	48117.14	0.109	48133.84	0.07	48116.96	0.422	48133.94	0.001	48116.87	0.229	48134.09	0.623	48116.4	0.293	48134.64	0.24	48116.15	0.312	48134.67	0.006	48116.13	0.062
'''